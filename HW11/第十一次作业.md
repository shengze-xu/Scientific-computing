<img src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20210612115833003.png" alt="image-20210612115833003"  />

## 第十一次作业

[TOC]

### 问题

1、使用幂法及反幂法求出$H_n$的最大特征值和最小特征值以及相应的特征向量，误差小于$\epsilon=10^{-14}$时停止，并利用这些值求出$H_n$的谱条件数，其中$n=1,2,\cdots,8$，分别画出$n$与最大、最小特征值及谱条件数的图像。

2、理论可以证明，$H_n$的最小特征值$\lambda_n$和阶数$n$的关系可以近似为$\lambda_n\approx ae^{bn}$，请利用上一题的数据和最小二乘法拟合出$a$和$b$，同时利用这个关系式预测$n=9$时$H_n$的最小特征值，然后利用反幂法求出$n=9$时$H_n$的最小特征值相比较。

3、同上一题，$H_n$的谱条件数$K_n$和阶数$n$的关系也可以近似为$K_n\approx pe^{qn}$，请利用第一题的数据和最小二乘法拟合出$p$和$q$，同时利用这个关系式预测$n=9$时$H_n$的谱条件数，然后利用幂法和反幂法求出$n=9$时$H_n$的谱条件数相比较。

4、利用经典$Jacobi$方法求出$H_n$的所有特征值及相应的特征向量，误差是最大的非对角元素的绝对值小于$\epsilon=10^{-14}$，其中$n=2,\cdots,8$。

### 数学原理

#### 1、幂法

根据书本第九章第一节的知识，设矩阵$A$的$n$个特征值按模由大到小排列如下：
$$
|\lambda_{1}|\geq|\lambda_{2}|\geq\cdots\geq|\lambda_{n}|
$$
其对应的特征向量为$v_1,v_2,\cdots,v_n$，并且是线性无关的，假定这些向量已按其长度或最大模元素进行了归一化。由于这些特征向量构成了$n$维空间的一组基，因此，初始向量$x^{(0)}$可以表示成特征向量的线性组合，进而可以构造出向量序列。

同时，如果按模最大的特征值$\lambda_{1}$为单实根，此时向量序列可以写为下面的形式：
$$
x^{(k)}=\lambda_{1}^k(\alpha_{1}v_1+\alpha_2(\frac{\lambda_{2}}{\lambda_{1}})^kv_2+\cdots+\alpha_n(\frac{\lambda_{n}}{\lambda_{1}})^kv_n)
$$
若$\alpha_{1}\neq0$，当$k$充分大时，$v_1$将成为主导，则：
$$
x^{(k)}=\lambda_{1}^k(\alpha_{1}v_1+\epsilon_k)
$$
此时通过迭代，进一步可以得到特征值$\lambda_{1}$的表达式为：
$$
\lambda_{1}\approx x_i^{(k+1)}/x_{i}^{(k)}
$$
实际计算时，为了避免计算过程中出现绝对值过大或过小的数参加运算，通常在每步迭代时，将向量“归一化”。即用的按模最大的分量$max_{1\leq i\leq n}|x_i^{(k)}|$来除$x^{(k)}$的各个分量，从而得出归一化的向量$y^{(k)}$，并令$x^{(k+1)}=Ay^{(k)}$。因而，实际计算时所用公式为：
$$
\left\{
\begin{aligned}
y^{(k)}&=x^{(k)}/||x^{(k)}||\\
x^{(k+1)}&=Ay^{(k)}
\end{aligned}
\right.
$$
当$k$充分大时，有如下表达式：
$$
\left\{
\begin{aligned}
&y^{(k)}\approx v_1\\
&max_{1\leq i\leq n}|x_i^{(k)}|\approx |\lambda_1|
\end{aligned}
\right.
$$

#### 2、反幂法

根据书本第九章第三节的知识，反幂法是用来求$A$的按模最小的特征值和对应特征向量的，求$A$的按模最小的特征值问题可以转化为求$A^{-1}$的按模最大的特征值，原理与幂法原理类似，实际计算时所用公式为：
$$
\left\{
\begin{aligned}
y^{(k)}&=x^{(k)}/||x^{(k)}||\\
Ax^{(k+1)}&=y^{(k)}
\end{aligned}
\right.
$$
因而当$k$充分大时，同理可得按模最小特征值及对应特征向量。

#### 3、最小二乘法

根据书本第三章第三节的知识，求一个经验函数形如$y=ae^{bx}$的公式，先对两边取常用对数得到$lgy=lga+bxlge$。令$u=lgy$，$A=lga$，$B=blge$，则有$u=A+Bx$。

此时等同于书本第三章第一节讲到的最基本的情况，为了求出$A、B$“最好”的值，令$\phi(A,B)=\sum_{i=1}^{n}\delta_i^2=\sum_{i=1}^n(u_i-A-Bx_i)^2$，求出$\phi(A,B)$后，对$A、B$求偏导，再使偏微商等于零，得到$A、B$应满足的方程，进而化简得到$A、B$的表达式：
$$
\left\{
\begin{aligned}
A&=\frac{1}{n}\sum_{i=1}^{n}u_i-\frac{1}{n}\sum_{i=1}^{n}x_iB\\
B&=\frac{\sum_{i=1}^{n}x_iy_i-\frac{1}{n}(\sum_{i=1}^{n}x_i)(\sum_{i=1}^{n}y_i)}{\sum_{i=1}^{n}x_i^2-\frac{1}{n}(\sum_{i=1}^{n}x_i)^2}
\end{aligned}
\right.
$$
代入相关各组数据，解得$A、B$的值后，再反代入解得$a、b$的值。

#### 4、经典$Jacobi$方法

$Jacobi$方法是一种用平面旋转矩阵所构成的正交相似变换将对称矩阵化为对角型的方法，所以也叫平面旋转法，适用于实对称矩阵。其具体的数学原理和算法理论较为复杂，在此不再赘述。

下面的程序和代码参考书本第九章P204~P208的理论知识及算法，并一定程度上参考了网络上已有的程序。需要说明的是，在进行微小角度计算的时候，我采取了根据反三角得到角度再进行三角函数计算的方法，并非通过某一特定三角函数值而推导得到其余相关三角函数值的方法。

### 程序及结果

#### 1、利用幂法与反幂法求解特征值及特征向量

##### （i）幂法函数

首先根据上述的数学原理和算法，定义幂法函数`function [c,y]=Power(A,x0,eps,N) `，函数中各参数值的意义如下：`c`代表按模最大特征值，`y`代表对应特征向量，$A$代表原矩阵，$x_0$代表初始向量，$eps$代表允许误差，$N$代表最大迭代次数。

```matlab
function [c,y]=	Power(A,x0,eps,N) 
    k=1;                       
    z=0;                
    y=x0./max(abs(x0)); 
    x=A*y;            
    xmax=max(x);         
    if abs(z-xmax)<eps      
        c=max(x);
        return;
    end
    while abs(z-xmax)>eps && k<N
        k=k+1;
        z=xmax;
        y=x./max(abs(x));   
        x=A*y;
        xmax=max(x);     
    end
    [m,i]=max(abs(x));   
    c=x(i);
end
```

##### （ii）反幂法函数

首先根据上述的数学原理和算法，定义烦幂法函数`function [c,y]=Inversepower(A,x0,eps,N)  `，函数中各参数值的意义如下：`c`代表按模最小特征值，`y`代表对应特征向量，$A$代表原矩阵，$x_0$代表初始向量，$eps$代表允许误差，$N$代表最大迭代次数。

```matlab
function [c,y]=Inversepower(A,x0,eps,N) 
    k=1; r=0;  
    y=x0./max(abs(x0)); 
    [L,U]=lu(A);
    z=L\y;
    x=U\z;
    xmax=max(x);
    c=1/xmax;         
    if abs(xmax-r)<eps  
        return
    end
    while abs(xmax-r)>eps && k<N
        k=k+1;
        r=xmax;
        y=x./max(abs(x));
        z=L\y;
        x=U\z;
        xmax=max(x);   
    end
    [m,i]=max(abs(x)); 
    c=1/x(i); 
end
```

##### （iii）主程序

定义了幂法函数与反幂法函数之后，我们进行主程序的编写。

首先定义三个数组：`eigenvalue1`、`eigenvalue2`、`cond`，为了使得在后面第二、三小题的解决过程中，可以直接使用本题的运行结果，更加便捷省力。

进行`for`循环，分别求出$n=1,2,\cdots,8$时矩阵的最大、最小特征值以及相应的特征向量，并根据这些值求得谱条件数。

```matlab
format long e
eigenvalue1=[];
eigenvalue2=[];
cond=[];
for n=1:8
    A=hilb(n);
    x0=ones(n,1);
    eps=1e-14;
    N=10000;
    [eigenvalue1(n),eigenvector1]=Power(A,x0,eps,N);
    [eigenvalue2(n),eigenvector2]=Inversepower(A,x0,eps,N);
    cond(n)=eigenvalue1(n)/eigenvalue2(n);
    fprintf("n=%d\n",n);
    fprintf("最大特征值=%e\n",eigenvalue1(n));
    fprintf("最大特征值对应向量=\n");
    disp(eigenvector1);
    fprintf("最小特征值=%e\n",eigenvalue2(n));
    fprintf("最小特征值对应向量=\n");
    disp(eigenvector2);
    fprintf("谱条件数=%e\n",cond(n));
end
```

##### （iv）运行结果

运行上述程序，得到了$n$不同取值情况下矩阵的最大、最小特征值及相应特征向量，矩阵的谱条件数。

```matlab
n=1
最大特征值=1.000000e+00
最大特征值对应向量=
     1
     
最小特征值=1.000000e+00
最小特征值对应向量=
     1
     
谱条件数=1.000000e+00
```

```matlab
n=2
最大特征值=1.267592e+00
最大特征值对应向量=
     1.000000000000000e+00
     5.351837584879965e-01
     
最小特征值=6.574145e-02
最小特征值对应向量=
    -5.351837584879964e-01
     1.000000000000000e+00
     
谱条件数=1.928147e+01
```

```matlab
n=3
最大特征值=1.408319e+00
最大特征值对应向量=
     1.000000000000000e+00
     5.560325556305697e-01
     3.909079479251085e-01
     
最小特征值=2.687340e-03
最小特征值对应向量=
     1.788579849323439e-01
    -1.000000000000000e+00
     9.648680020455513e-01
     
谱条件数=5.240568e+02
```

```matlab
n=4
最大特征值=1.500214e+00
最大特征值对应向量=
     1.000000000000000e+00
     5.701720836632361e-01
     4.067789880275295e-01
     3.181409688737942e-01
     
最小特征值=9.670230e-05
最小特征值对应向量=
    -3.688768261414128e-02
     4.153492877803119e-01
    -1.000000000000000e+00
     6.501712197336791e-01
     
谱条件数=1.551374e+04
```

```matlab
n=5
最大特征值=1.567051e+00
最大特征值对应向量=
     1.000000000000000e+00
     5.805669224980483e-01
     4.188009525690565e-01
     3.300610540917679e-01
     2.732582440162324e-01
     
最小特征值=3.287929e-06
最小特征值对应向量=
     8.047359657367076e-03
    -1.521038665452488e-01
     6.597620813621521e-01
    -1.000000000000000e+00
     4.904195314350933e-01
     
谱条件数=4.766073e+05
```

```matlab
n=6
最大特征值=1.618900e+00
最大特征值对应向量=
     1.000000000000000e+00
     5.886285434255437e-01
     4.283272844289567e-01
     3.396618918387101e-01
     2.825235879421498e-01
     2.423378111228499e-01
     
最小特征值=1.082799e-07
最小特征值对应向量=
    -1.809482541432804e-03
     5.161825359413210e-02
    -3.489077525350973e-01
     9.067176845779817e-01
    -1.000000000000000e+00
     3.937411114938384e-01
     
谱条件数=1.495106e+07
```

```matlab
n=7
最大特征值=1.660885e+00
最大特征值对应向量=
     1.000000000000000e+00
     5.951226310651339e-01
     4.361264973570401e-01
     3.476222805785348e-01
     2.902845642245986e-01
     2.497773060663220e-01
     2.194954319232115e-01
     
最小特征值=3.493899e-09
最小特征值对应向量=
     3.590989182523254e-04
    -1.441497227435825e-02
     1.394747380425316e-01
    -5.440350887668229e-01
     1.000000000000000e+00
    -8.659476901703924e-01
     2.848313656494277e-01
     
谱条件数=4.753674e+08
```

```matlab
n=8
最大特征值=1.695939e+00
最大特征值对应向量=
     1.000000000000000e+00
     6.005042457579541e-01
     4.426715540119190e-01
     3.543704469996981e-01
     2.969185784445075e-01
     2.561809294869808e-01
     2.256293688082280e-01
     2.017901870379185e-01
     
最小特征值=1.111539e-10
最小特征值对应向量=
    -6.861039262918063e-05
     3.687877069313321e-03
    -4.826725467282643e-02
     2.617134001487704e-01
    -7.057473477498621e-01
     1.000000000000000e+00
    -7.125091377039546e-01
     2.012418341361100e-01   
     
谱条件数=1.525757e+10
```

##### （v）图像

为了得到$n$与最大、最小特征值及谱条件数的图像，利用`plot`函数，编写以下绘图程序。

```matlab
x=[1 2 3 4 5 6 7 8];
plot(x,eigenvalue1);
xlabel('n阶矩阵');
ylabel('最大特征值');
```

```matlab
x=[1 2 3 4 5 6 7 8];
plot(x,eigenvalue2);
xlabel('n阶矩阵');
ylabel('最小特征值');
```

```matlab
x=[1 2 3 4 5 6 7 8];
plot(x,cond);
xlabel('n阶矩阵');
ylabel('谱条件数');
```

得到$n$与最大特征值的图像如下：

<img src="C:\Users\DELL\Desktop\科学计算\HW11\最大特征值.png" style="zoom: 67%;" />

得到$n$与最小特征值的图像如下：

<img src="C:\Users\DELL\Desktop\科学计算\HW11\最小特征值.png" style="zoom: 67%;" />

得到$n$与谱条件数的图像如下：

<img src="C:\Users\DELL\Desktop\科学计算\HW11\谱条件数.png" style="zoom:67%;" />

#### 2、最小二乘法预测特征值

##### （i）最小二乘法程序

```matlab
format long e
x=[];
y=[];
for n=1:8
    x(n)=n;
    y(n)=log(abs(eigenvalue2(n)));
end
%y=A+Bx;
xy=[];
x2=[];
for n=1:8
    xy(n)=x(n)*y(n);
    x2(n)=x(n)*x(n);
end
B=(sum(xy(1:8))-1/8*sum(x(1:8))*sum(y(1:8)))/(sum(x2(1:8))-1/8*(sum(x(1:8)))*(sum(x(1:8))));
A=1/8*sum(y(1:8))-1/8*sum(x(1:8)*B);
a=exp(1)^A;
b=B/log(exp(1));
disp(a);
disp(b);
```

##### （ii）预测结果

运行程序，得到$a$和$b$的值为：
$$
\left\{
\begin{aligned}
a&=4.344595024103241\times10^1\\
b&=-3.308705415224152
\end{aligned}
\right.
$$

根据公式$\lambda_n=ae^{bn}$，代入解得当$n=9$时，$H_n$的最小特征值为$5.074291187\times10^{-12}$。

##### （ii）反幂法求解

根据第一题中的程序，代入$n=9$得到最小特征值为$3.49969\times10^{-12}$。

两者差值为$1.5746\times 10^{-12}$。

#### 3、最小二乘法预测谱条件数

##### （i）最小二乘法程序

```matlab
format long e
x=[];
y=[];
for n=1:8
    x(n)=n;
    y(n)=log(abs(cond(n)));
end
%y=P+Qx;
xy=[];
x2=[];
for n=1:8
    xy(n)=x(n)*y(n);
    x2(n)=x(n)*x(n);
end
Q=(sum(xy(1:8))-1/8*sum(x(1:8))*sum(y(1:8)))/(sum(x2(1:8))-1/8*(sum(x(1:8)))*(sum(x(1:8))));
P=1/8*sum(y(1:8))-1/8*sum(x(1:8)*Q);
p=exp(1)^P;
q=Q/log(exp(1));
disp(p);
disp(q);
```

##### （ii）预测结果

运行程序，得到$p$和$q$的值为：
$$
\left\{
\begin{aligned}
p&=2.477887430556874\times10^{-2}\\
q&=3.374306044242184
\end{aligned}
\right.
$$

根据公式$K_n=pe^{qn}$，代入解得当$n=9$时，$H_n$的谱条件数为$3.82881\times10^{11}$。

##### （iii）幂法与反幂法求解

根据第一题中的程序，代入$n=9$得到谱条件数为$4.931528\times10^{11}$。

两者差值为$-1.102718\times 10^{11}$。

#### 4、经典$Jacobi$方法求解特征值及特征向量

##### （i）经典$Jacobi$方法函数

首先根据上述的数学原理和算法，定义经典$Jacobi$方法函数`function [c,y]=Jacobi(A,eps) `，函数中各参数值的意义如下：`c`代表特征值，`y`代表对应特征向量，$A$代表原矩阵，$eps$代表允许误差。

```matlab
function [c,y]=Jacobi(A,eps)
    n=size(A); 
    y=eye(n); 
    A1=eye(n); 
    p=1; 
    q=2; 
    for i=1:n 
        for j=i+1:n 
            if abs(A(i,j))>abs(A(p,q)) 
            p=i; 
            q=j; 
            end
        end
    end
    while abs(A(p,q))>=eps 
        A1=eye(n); 
        cot2=(A(p,p)-A(q,q))/(2*A(p,q)); 
        theta=acot(cot2)/2;
        cos1=cos(theta);
        sin1=sin(theta);
        sin2=sin(2*theta); 
        cos2=cos(2*theta); 
        R=y; 
        for i=1:n 
            y(i,p)=R(i,p)*cos1+R(i,q)*sin1; 
            y(i,q)=-R(i,p)*sin1+R(i,q)*cos1;
            for j=1:n 
                if j~=p&&j~=q y(i,j)=R(i,j); 
                end
            end
        end
        A1(p,p)=A(p,p)*cos1*cos1+A(q,q)*sin1*sin1+A(p,q)*sin2; 
        A1(q,q)=A(p,p)*sin1*sin1+A(q,q)*cos1*cos1-A(p,q)*sin2; 
        A1(p,q)=0.5*(A(q,q)-A(p,p))*sin2+A(p,q)*cos2; 
        A1(q,p)=A1(p,q); 
        for j=1:n 
            if j~=p&&j~=q 
                A1(p,j)=A(p,j)*cos1+A(q,j)*sin1; 
                A1(q,j)=-A(p,j)*sin1+A(q,j)*cos1; 
                A1(j,p)=A1(p,j);
                A1(j,q)=A1(q,j); 
            end
        end
        for i=1:n 
            for j=1:n 
                if i~=p&&i~=q&&j~=p&&j~=q 
                    A1(i,j)=A(i,j); 
                    A1(j,i)=A1(i,j); 
                end
            end
        end
        A=A1; 
        c=diag(A1)';
        p=1; 
        q=2; 
        for i=1:n 
            for j=i+1:n 
                if abs(A(i,j))>abs(A(p,q)) 
                    p=i; 
                    q=j; 
                end
            end
        end
    end
end
```

需要特别注意的是，代码中对于旋转角度相关量的计算的处理方式为：

```matlab
cot2=(A(p,p)-A(q,q))/(2*A(p,q)); 
theta=acot(cot2)/2;
cos1=cos(theta);
sin1=sin(theta);
sin2=sin(2*theta); 
cos2=cos(2*theta); 
```

而非采用直接进行三角函数值代入公式进行计算的方式：

```matlab
cot2=(A(p,p)-A(q,q))/(2*A(p,q));
sin2=sqrt(1/(1+cot2*cot2));
cos2=sqrt(1-sin2*sin2);
cos1=sqrt((cos2+1)/2);
sin1=sqrt(1-cos1*cos1);
```

采用第一种方式，在一定程度上减小了计算过程中因为角度过小而带来的误差。

##### （ii）运行结果

```matlab
n=2
特征值=
   1.2676e+00   6.5741e-02

特征向量=
   8.8167e-01  -4.7186e-01
   4.7186e-01   8.8167e-01
```

```matlab
n=3
特征值=
   1.4083e+00   1.2233e-01   2.6873e-03

特征向量=
   8.2704e-01  -5.4745e-01   1.2766e-01
   4.5986e-01   5.2829e-01  -7.1375e-01
   3.2330e-01   6.4901e-01   6.8867e-01
```

```matlab
n=4
特征值=
   1.5002e+00   1.6914e-01   9.6702e-05   6.7383e-03

特征向量=
   7.9261e-01  -5.8208e-01   2.9193e-02   1.7919e-01
   4.5192e-01   3.7050e-01  -3.2871e-01  -7.4192e-01
   3.2242e-01   5.0958e-01   7.9141e-01   1.0023e-01
   2.5216e-01   5.1405e-01  -5.1455e-01   6.3828e-01
```

```matlab
n=5
特征值=
   1.5671e+00   2.0853e-01   3.0590e-04   3.2879e-06   1.1407e-02

特征向量=
   7.6785e-01  -6.0187e-01   4.7162e-02  -6.1739e-03   2.1421e-01
   4.4579e-01   2.7591e-01  -4.3267e-01   1.1669e-01  -7.2410e-01
   3.2158e-01   4.2488e-01   6.6735e-01  -5.0616e-01  -1.2045e-01
   2.5344e-01   4.4390e-01   2.3302e-01   7.6719e-01   3.0957e-01
   2.0982e-01   4.2901e-01  -5.5760e-01  -3.7625e-01   5.6519e-01
```

```matlab
n=6
特征值=
   1.6189e+00   2.4236e-01   6.1575e-04   1.2571e-05   1.0828e-07   1.6322e-02

特征向量=
   7.4872e-01  -6.1454e-01   6.2227e-02  -1.1144e-02   1.2482e-03   2.4033e-01
   4.4072e-01   2.1108e-01  -4.9084e-01   1.7973e-01  -3.5607e-02  -6.9765e-01
   3.2070e-01   3.6589e-01   5.3548e-01  -6.0421e-01   2.4068e-01  -2.3139e-01
   2.5431e-01   3.9471e-01   4.1704e-01   4.4357e-01  -6.2546e-01   1.3286e-01
   2.1153e-01   3.8819e-01  -4.7034e-02   4.4154e-01   6.8981e-01   3.6271e-01
   1.8144e-01   3.7070e-01  -5.4068e-01  -4.5911e-01  -2.7161e-01   5.0276e-01
```

```matlab
n=7
特征值=
   1.6609e+00   2.7192e-01   1.0086e-03   3.4939e-09   2.9386e-05   4.8568e-07   2.1290e-02

特征向量=
   7.3323e-01  -6.2324e-01   7.5187e-02  -2.4510e-04  -1.5994e-02   2.4687e-03   2.6084e-01
   4.3636e-01   1.6307e-01  -5.2678e-01   9.8386e-03   2.2790e-01  -6.1797e-02  -6.7056e-01
   3.1978e-01   3.2151e-01   4.2566e-01  -9.5196e-02  -6.2875e-01   3.4867e-01  -2.9533e-01
   2.5489e-01   3.5737e-01   4.6168e-01   3.7132e-01   2.0037e-01  -6.4469e-01   2.3047e-02
   2.1284e-01   3.5707e-01   1.7120e-01  -6.8253e-01   4.9702e-01   1.7439e-01   2.3369e-01
   1.8314e-01   3.4457e-01  -1.8266e-01   5.9103e-01   1.8487e-01   5.4363e-01   3.6788e-01
   1.6094e-01   3.2813e-01  -5.0975e-01  -1.9441e-01  -4.8076e-01  -3.6474e-01   4.5235e-01
```

```matlab
n=8
特征值=
   1.6959e+00   2.9813e-01   1.4677e-03   1.7989e-08   5.4369e-05   1.2943e-06   1.1115e-10   2.6213e-02

特征向量=
   7.2027e-01  -6.2948e-01   8.6517e-02  -5.2387e-04  -2.0656e-02   3.8106e-03   4.7154e-05   2.7755e-01
   4.3253e-01   1.2567e-01  -5.5014e-01   1.8809e-02   2.6613e-01  -8.5791e-02  -2.5346e-03  -6.4493e-01
   3.1884e-01   2.8642e-01   3.3625e-01  -1.5800e-01  -6.2407e-01   4.1879e-01   3.3173e-02  -3.3515e-01
   2.5524e-01   3.2757e-01   4.5925e-01   4.9454e-01   3.1954e-02  -5.7971e-01  -1.7987e-01  -5.1307e-02
   2.1386e-01   3.3209e-01   2.7565e-01  -5.6650e-01   4.1938e-01  -1.2321e-01   4.8504e-01   1.4402e-01
   1.8452e-01   3.2354e-01   1.1272e-02  -7.4693e-02   3.6553e-01   4.1851e-01  -6.8728e-01   2.7286e-01
   1.6251e-01   3.1027e-01  -2.4896e-01   5.6884e-01   1.8007e-02   3.5236e-01   4.8969e-01   3.5704e-01
   1.4534e-01   2.9562e-01  -4.7728e-01  -2.8290e-01  -4.7797e-01  -4.0826e-01  -1.3831e-01   4.1158e-01
```

### 思考讨论

本次实验中，以希尔伯特矩阵为研究对象，利用幂法、反幂法求解矩阵的按模最大、最小特征值及谱条件数，利用最小二乘法拟合出关系曲线并预测了矩阵的相关量，最后利用经典$Jacobi$方法求出了$n$阶希尔伯特矩阵的所有特征值及特征向量。

在第一题的求解过程中，我们虽然设了一个变量$N$来控制迭代次数，但取得足够大便足矣达到目标误差所需的迭代次数。从图像中可以看出，最大特征值随着阶数的增长变化不大， 最小特征值和谱条件数随着阶数的增长变化非常大，变化速率不断提高，量级变化显著。

在第二题和第三题的求解过程中，我们虽然通过最小二乘法拟合出了相关的曲线，并对希尔伯特矩阵的阶数到达$9$时的情况作出了预测，但与利用幂法、反幂法求出的较为精确的值相比，仍然有较大的差距。这说明仅依靠经验函数拟合曲线的方法仍然不够精确，实际曲线的变化速率与自然指数级有一定的差距。

第四题利用经典$Jacobi$方法求解希尔伯特矩阵的所有特征值和特征向量，主要在对微小角的处理方式上面进行了一定的改善和优化。从程序运行的结果来看，通过这种方法求解得到的按模最大、最小特征值与第一小题中利用幂法与反幂法计算得到的结果基本一致，这也说明经典$Jacobi$方法的精确程度也比较高。

通过这四道题的求解，我们发现在不同情况下，为了达到计算更精确和算法消耗时间更少的目的，我们要视不同情况综合考量而采取最合适的方法，同时在极端情况下也要对算法进行合理的优化，从而得到最优解法。
